<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="utf-8">
  <title>Dados Boqueirão</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
</head>

<body>
  <div class="container">
    <div class="row">
      <h2>Minha Visualização</h2>
    </div>
    <div class="row mychart" id="chart">
    </div>
  </div>

  <script type="text/javascript">
    "use strict"

// definicoes de altura e largura do svg e da vis dentro
    var alturaSVG = 600, larguraSVG = 2000;

    function desenhaCirculos(dados) {

      /*
       * Prepara onde adicionaremos a visualizacao
       */
        var grafico = d3.select('#chart') // cria elemento <svg> com um <g> dentro
            .append('svg')
            .attr('width', larguraSVG)
            .attr('height', alturaSVG)

      /*
       * As marcas
       */
    var graphic = grafico.selectAll('g')
            .data(dados)
            .enter()
            .append('g')

      /*
       * Os eixos
       */
        graphic.append("circle")
            .attr("cx", function(d){return (d.mes) * 125;})
            .attr("cy", 250)
            .attr("r", function(d){return d.noventa_percentil * 0.6;})
            .style("fill", "steelblue");

        graphic.append('circle')
            .attr('cx', function(d){return (d.mes) * 125;})
            .attr("cy", 250)
            .attr("r", function(d){return d.dez_percentil;})
            .style("fill", "goldenrod");

        graphic.append("text")
            .text(function(d){return d.mes;})
            .attr("x", function(d){(d.mes) * 125 - 8;})
            .attr("y", 250);
      // Preencha aqui.
    }

    d3.tsv('dados/boqueirao-por-mes.csv', function(dados) {
      console.log("provavelmente acontece depois")
      desenhaCirculos(dados);
    });

    console.log("provavelmente acontece primeiro") // me apague quando entender.

    /*
    * Assim como a função d3.tsv, existe a d3.csv e a d3.json
    * Em todas, o primeiro parâmetro é uma URL e o segundo a função que
    * será executada quando o dado for obtido.
    * >>>>> A chamada ao d3.tsv é assíncrona <<<<<<
    */
  </script>
</body>

</html>
